<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapports Commerciaux</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2196F3">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📋</text></svg>">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header" id="header">
            <div class="user-info">
                <div class="avatar" id="userAvatar">U</div>
                <div>
                    <div id="userName">Utilisateur</div>
                    <div class="user-role" id="userRole">Commercial</div>
                </div>
            </div>
            <div class="nav-buttons">
                <button class="nav-btn" id="navBrouillon">📝 Brouillons</button>
                <button class="nav-btn" id="navRapports">📊 Rapports</button>
                <button class="nav-btn logout" id="logoutBtn">🚪</button>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div id="mainContent">
            
            <!-- PAGE LOGIN -->
            <div class="page login-page" id="loginPage" style="display: block;">
                <div class="logo">🏢</div>
                <h1>Connexion</h1>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">👤 Nom d'utilisateur</label>
                        <input type="text" id="username" name="username" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="password">🔒 Mot de passe</label>
                        <input type="password" id="password" name="password" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="login-btn" id="loginBtn">Se connecter</button>
                    <div class="error-message" id="errorMessage"></div>
                    <div class="loading" id="loadingMessage">
                        <div class="loading-spinner"></div>
                        Connexion en cours...
                    </div>
                </form>
            </div>

            <!-- PAGE BROUILLON -->
            <div class="page" id="brouillonPage" style="display: none;">
                <h1>📝 Brouillons</h1>
                
                <!-- Section Enregistrement -->
                <div class="recording-section">
                    <h3>🎤 Créer un nouveau rapport</h3>
                    
                    <!-- Options d'ajout -->
                    <div class="input-options">
                        <div class="option-group">
                            <h4>Enregistrer un vocal</h4>
                            <div class="record-button" id="recordBtn">⏺️</div>
                            <div id="recordingStatus">Appuyer pour enregistrer</div>
                            
                            <div class="audio-controls" id="audioControls">
                                <button class="audio-btn" id="playBtn">▶️ Écouter</button>
                                <button class="audio-btn" id="reRecordBtn">🔄 Refaire</button>
                            </div>
                        </div>
                        
                        <div class="option-divider">OU</div>
                        
                        <div class="option-group">
                            <h4>Importer un fichier audio</h4>
                            <input type="file" id="audioFileInput" accept="audio/*" style="display: none;">
                            <button class="upload-btn" id="uploadBtn">📁 Choisir un fichier</button>
                            <div id="uploadStatus"></div>
                        </div>
                    </div>
                    
                    <button class="send-btn" id="sendAudioBtn">📤 Envoyer pour traitement</button>
                </div>

                <!-- Liste des brouillons -->
                <div>
                    <h3>📋 Rapports en attente de validation :</h3>
                    <div class="reports-list" id="brouillonsList">
                        <div class="empty-state">
                            <div class="icon">📄</div>
                            <p>Aucun brouillon pour le moment</p>
                            <p class="empty-subtitle">Enregistrez ou importez votre premier rapport vocal !</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PAGE RAPPORTS -->
            <div class="page" id="rapportsPage" style="display: none;">
                <h1>📊 Rapports finalisés</h1>
                
                <!-- Section Recherche -->
                <div class="search-section">
                    <input type="text" class="search-input" id="searchInput" placeholder="🔍 Rechercher un rapport...">
                </div>

                <!-- Stats -->
                <div class="stats-section">
                    ✅ Rapports validés : <span id="rapportsCount">0</span>
                    📄 PDF générés : <span id="pdfCount">0</span>
                </div>

                <!-- Liste des rapports -->
                <div class="reports-list" id="rapportsList">
                    <div class="empty-state">
                        <div class="icon">📋</div>
                        <p>Aucun rapport finalisé</p>
                        <p class="empty-subtitle">Validez vos brouillons pour les voir ici !</p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Scripts -->
     <script src="js/google-sheets-manager.js"></script>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/audio-manager.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => console.log('SW registered'))
                    .catch(err => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>